(function(a,b){"function"==typeof define&&define.amd?define(["ScrollMagic"],b):"object"==typeof exports?b(require("scrollmagic")):b(a.ScrollMagic||a.jQuery&&a.jQuery.ScrollMagic)})(this,function(a){"use strict";var b=window.console||{},c=Function.prototype.bind.call(b.error||b.log||function(){},b);a||c("(debug.addIndicators) -> ERROR: The ScrollMagic main module could not be found. Please make sure it's loaded before this plugin or use an asynchronous loader like requirejs.");var d=a._util,e=0;a.Scene.extend(function(){var a,b=this;b.addIndicators=function(c){if(!a){c=d.extend({},{name:"",indent:0,parent:void 0,colorStart:"transparent",colorEnd:"transparent",colorTrigger:"transparent"},c),e++,a=new f(b,c),b.on("add.plugin_addIndicators",a.add),b.on("remove.plugin_addIndicators",a.remove),b.on("destroy.plugin_addIndicators",b.removeIndicators),b.controller()&&a.add()}return b},b.removeIndicators=function(){return a&&(a.remove(),this.off("*.plugin_addIndicators"),a=void 0),b}}),a.Controller.addOption("addIndicators",!1),a.Controller.extend(function(){var b=this,c=b.info(),e=c.container,f=c.isDocument,h=c.vertical,j={groups:[]};b._indicators&&function(){b._log&&(Array.prototype.splice.call(arguments,1,0,"(debug.addIndicators)","->"),b._log.apply(this,arguments))}(2,"WARNING: Scene already has a property '_indicators', which will be overwritten by plugin."),this._indicators=j;var k=function(){j.updateBoundsPositions()},l=function(){j.updateTriggerGroupPositions()};return e.addEventListener("resize",l),f||(window.addEventListener("resize",l),window.addEventListener("scroll",l)),e.addEventListener("resize",k),e.addEventListener("scroll",k),this._indicators.updateBoundsPositions=function(a){for(var c,f,i,k=a?[d.extend({},a.triggerGroup,{members:[a]})]:j.groups,l=k.length,m={},n=h?"left":"top",o=h?"width":"height",p=h?d.get.scrollLeft(e)+d.get.width(e)-15:d.get.scrollTop(e)+d.get.height(e)-15;l--;)for(i=k[l],c=i.members.length,f=d.get[o](i.element.firstChild);c--;)m[n]=p-f,d.css(i.members[c].bounds,m)},this._indicators.updateTriggerGroupPositions=function(a){for(var c,g,k,l,m,n=a?[a]:j.groups,o=n.length,p=f?document.body:e,q=f?{top:0,left:0}:d.get.offset(p,!0),r=h?d.get.width(e)-15:d.get.height(e)-15,s=h?"width":"height",t=h?"Y":"X";o--;)c=n[o],g=c.element,k=c.triggerHook*b.info("size"),l=d.get[s](g.firstChild.firstChild),m=k>l?"translate"+t+"(-100%)":"",d.css(g,{top:q.top+(h?k:r-c.members[0].options.indent),left:q.left+(h?r-c.members[0].options.indent:k)}),d.css(g.firstChild.firstChild,{"-ms-transform":m,"-webkit-transform":m,transform:m})},this._indicators.updateTriggerGroupLabel=function(a){var b="trigger"+(1<a.members.length?"":" "+a.members[0].options.name),c=a.element.firstChild.firstChild,d=c.textContent!==b;d&&(c.textContent=b,h&&j.updateBoundsPositions())},this.addScene=function(c){this._options.addIndicators&&c instanceof a.Scene&&c.controller()===b&&c.addIndicators(),this.$super.addScene.apply(this,arguments)},this.destroy=function(){e.removeEventListener("resize",l),f||(window.removeEventListener("resize",l),window.removeEventListener("scroll",l)),e.removeEventListener("resize",k),e.removeEventListener("scroll",k),this.$super.destroy.apply(this,arguments)},b});var f=function(a,b){var c,f,h=this,i=g.bounds(),j=g.start(b.colorStart),k=g.end(b.colorEnd),l=b.parent&&d.get.elements(b.parent)[0],m=function(){a._log&&(Array.prototype.splice.call(arguments,1,0,"(debug.addIndicators)","->"),a._log.apply(this,arguments))};b.name=b.name||e,j.firstChild.textContent+=" "+b.name,k.textContent+=" "+b.name,i.appendChild(j),i.appendChild(k),h.options=b,h.bounds=i,h.triggerGroup=void 0,this.add=function(){f=a.controller(),c=f.info("vertical");var b=f.info("isDocument");l||(l=b?document.body:f.info("container")),b||"static"!==d.css(l,"position")||d.css(l,{position:"relative"}),a.on("change.plugin_addIndicators",o),a.on("shift.plugin_addIndicators",n),u(),r(),setTimeout(function(){f._indicators.updateBoundsPositions(h)},0),m(3,"added indicators")},this.remove=function(){if(h.triggerGroup){if(a.off("change.plugin_addIndicators",o),a.off("shift.plugin_addIndicators",n),1<h.triggerGroup.members.length){var b=h.triggerGroup;b.members.splice(b.members.indexOf(h),1),f._indicators.updateTriggerGroupLabel(b),f._indicators.updateTriggerGroupPositions(b),h.triggerGroup=void 0}else t();q(),m(3,"removed indicators")}};var n=function(){r()},o=function(a){"triggerHook"===a.what&&u()},p=function(){var a=f.info("vertical");d.css(j.firstChild,{"border-bottom-width":a?1:0,"border-right-width":a?0:1,bottom:a?-1:b.indent,right:a?b.indent:-1,padding:a?"0 8px":"2px 4px"}),d.css(k,{"border-top-width":a?1:0,"border-left-width":a?0:1,top:a?"100%":"",right:a?b.indent:"",bottom:a?"":b.indent,left:a?"":"100%",padding:a?"0 8px":"2px 4px"}),l.appendChild(i)},q=function(){i.parentNode.removeChild(i)},r=function(){i.parentNode!==l&&p();var b={};b[c?"top":"left"]=a.triggerPosition(),b[c?"height":"width"]=a.duration(),d.css(i,b),d.css(k,{display:0<a.duration()?"":"none"})},s=function(){var e=g.trigger(b.colorTrigger),i={};i[c?"right":"bottom"]=0,i[c?"border-top-width":"border-left-width"]=1,d.css(e.firstChild,i),d.css(e.firstChild.firstChild,{padding:c?"0 8px 3px 8px":"3px 4px"}),document.body.appendChild(e);var j={triggerHook:a.triggerHook(),element:e,members:[h]};f._indicators.groups.push(j),h.triggerGroup=j,f._indicators.updateTriggerGroupLabel(j),f._indicators.updateTriggerGroupPositions(j)},t=function(){f._indicators.groups.splice(f._indicators.groups.indexOf(h.triggerGroup),1),h.triggerGroup.element.parentNode.removeChild(h.triggerGroup.element),h.triggerGroup=void 0},u=function(){var b=a.triggerHook(),c=1e-4;if(!(h.triggerGroup&&Math.abs(h.triggerGroup.triggerHook-b)<c)){for(var d,e=f._indicators.groups,g=e.length;g--;)if(d=e[g],Math.abs(d.triggerHook-b)<c)return h.triggerGroup&&(1===h.triggerGroup.members.length?t():(h.triggerGroup.members.splice(h.triggerGroup.members.indexOf(h),1),f._indicators.updateTriggerGroupLabel(h.triggerGroup),f._indicators.updateTriggerGroupPositions(h.triggerGroup))),d.members.push(h),h.triggerGroup=d,void f._indicators.updateTriggerGroupLabel(d);if(h.triggerGroup){if(1===h.triggerGroup.members.length)return h.triggerGroup.triggerHook=b,void f._indicators.updateTriggerGroupPositions(h.triggerGroup);h.triggerGroup.members.splice(h.triggerGroup.members.indexOf(h),1),f._indicators.updateTriggerGroupLabel(h.triggerGroup),f._indicators.updateTriggerGroupPositions(h.triggerGroup),h.triggerGroup=void 0}s()}}},g={start:function(a){var b=document.createElement("div");b.textContent="start",d.css(b,{position:"absolute",overflow:"visible","border-width":0,"border-style":"solid",color:"transparent","border-color":a});var c=document.createElement("div");return d.css(c,{position:"absolute",overflow:"visible",width:0,height:0,color:"transparent"}),c.appendChild(b),c},end:function(a){var b=document.createElement("div");return b.textContent="end",d.css(b,{position:"absolute",overflow:"visible","border-width":0,"border-style":"solid",color:"transparent","border-color":a}),b},bounds:function(){var a=document.createElement("div");return d.css(a,{position:"absolute",overflow:"visible","white-space":"nowrap","pointer-events":"none","font-size":"0.85em",color:"transparent"}),a.style.zIndex="9999",a},trigger:function(a){var b=document.createElement("div");b.textContent="trigger",d.css(b,{position:"relative",color:"transparent"});var c=document.createElement("div");d.css(c,{position:"absolute",overflow:"visible","border-width":0,"border-style":"solid",color:"transparent","border-color":a}),c.appendChild(b);var f=document.createElement("div");return d.css(f,{position:"fixed",overflow:"visible","white-space":"nowrap","pointer-events":"none",color:"transparent","font-size":"0.85em"}),f.style.zIndex="9999",f.appendChild(c),f}}});